{{ if or (not (isset .Params "render")) (.Params.render) }}
<!DOCTYPE html>
<html>
<head>
  <title>{{ block "title" . }}{{ .Title }}{{ end }}</title>

  {{ $styleUSWDS := resources.Get "scss/uswds-custom.scss" | resources.ExecuteAsTemplate "uswds.scss" . | toCSS | minify }}
  {{ $secureStyle := $styleUSWDS | resources.Fingerprint "sha512" }}
  <link rel="stylesheet" href="{{ $styleUSWDS.Permalink }}" integrity="{{ $secureStyle.Data.Integrity }}">

  {{ range .Site.Params.custom_css -}}
    {{ $style := resources.Get . | resources.Minify }}
    {{ $secureStyle := $style | resources.Fingerprint "sha512" }}
    <link rel="stylesheet" href="{{ $style.Permalink }}" integrity="{{ $secureStyle.Data.Integrity }}">
  {{- end }}
  {{ range .Page.Params.custom_css -}}
    {{ $style := resources.Get . }}
    {{ if $style }}
      {{ $style := $style | resources.Minify }}
      {{ $secureStyle := $style | resources.Fingerprint "sha512" }}
      <link rel="stylesheet" href="{{ $style.Permalink }}" integrity="{{ $secureStyle.Data.Integrity }}">
    {{ end }}
  {{- end }}
</head>
<body>
{{ block "main" . }}
{{ end }}
{{ $main := resources.Get "/js/uswds.js" }}

{{ $js := slice $main | resources.Concat "/js/site.js" | minify }}
{{ $secureJS := $js | resources.Fingerprint "sha512" }}
<script type="text/javascript" src="{{ $js.Permalink }}" integrity="{{ $secureJS.Data.Integrity }}"></script>
{{ range .Site.Params.custom_js -}}
  {{ $js := resources.Get . | resources.Minify }}
  {{ $secureJS := $js | resources.Fingerprint "sha512" }}
  <script src="{{ $js.Permalink }}" integrity="{{ $secureJS.Data.Integrity }}"></script>
{{- end }}
{{ range .Page.Params.custom_js -}}
  {{ $js := resources.Get . }}
  {{ $js := $js | resources.Minify }}
  {{ $secureJS := $js | resources.Fingerprint "sha512" }}
  <script src="{{ $js.Permalink }}" integrity="{{ $secureJS.Data.Integrity }}"></script>
{{- end }}
</body>
</html>
{{ end }}
