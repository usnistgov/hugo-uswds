{{ if or (not (isset .Params "render")) (.Params.render) }}
<!DOCTYPE html>
<html>
<head>
  <title>{{ block "title" . }}{{ .Title }}{{ end }}</title>

  <script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>

  {{ $uswdsCSS := resources.Get "scss/uswds-hugo.scss" | resources.ExecuteAsTemplate "uswds.scss" . | toCSS }}
  {{ $siteCSS := slice $uswdsCSS }}
  {{ range .Site.Params.custom_css -}}
    {{ $style := resources.Get . }}
    {{ $siteCSS = $siteCSS | append $style }}
  {{- end }}
  {{ $siteCSSmin := $siteCSS | resources.Concat "/css/site.css" | minify }}
  {{ $siteCSSminSecure := $siteCSSmin | resources.Fingerprint "sha512" }}
  <link rel="stylesheet" href="{{ $siteCSSmin.Permalink }}" integrity="{{ $siteCSSminSecure.Data.Integrity }}" />

{{ block "head" . }}
{{ partial "head.html" . }}
{{ end }}

  {{ if (isset .Page.Params "custom_css" ) and (.Page.Params.custom_css "!=" nil) }}
  {{ range .Page.Params.custom_css -}}
    {{ $style := resources.Get . }}
    {{ $pageCSSmin := $style | minify }}
    {{ $pageCSSminSecure := $pageCSSmin | resources.Fingerprint "sha512" }}
    <link rel="stylesheet" href="{{ $pageCSSmin.Permalink }}" integrity="{{ $pageCSSminSecure.Data.Integrity }}" />
  {{- end }}
  {{ end }}
</head>
<body>
{{ block "main" . }}
{{ partial "head.html" . }}
{{ end }}
<p class="font-sans-sm text-center ">This page was last updated on {{ .Lastmod.Format "January 2, 2006" }}.{{ if .Site.Params.contentRepoPath }} <button onclick="window.location.href = '{{ .Site.Params.contentRepoPath }}/{{ .File.Path }}';" class="usa-button usa-button--accent-cool">Improve this Page</button>{{ end }}</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" integrity="sha384-S2Sj9dbj135Vzm4xwOrcyOA/FlODQj514E6Il+ayOB/Y0YClPg5BpCy7lG2G8wtV" crossorigin="anonymous"></script>

{{ $uswdsJS := resources.Get "/js/uswds.js" }}
{{ $rwdImgMaps := resources.Get "/js/jquery.rwdImageMaps.js" }}
{{ $siteJS := slice $uswdsJS $rwdImgMaps }}
{{ range .Site.Params.custom_css -}}
  {{ $js := resources.Get . }}
  {{ $siteJS = $siteJS | append $js }}
{{- end }}
{{ $siteJSmin := $siteJS | resources.Concat "/js/site.js" | minify }}
{{ $siteJSminSecure := $siteJSmin | resources.Fingerprint "sha512" }}
<script type="text/javascript" src="{{ $siteJSmin.Permalink }}" integrity="{{ $siteJSminSecure.Data.Integrity }}"></script>

{{ if (isset .Page.Params "custom_js" ) and (.Page.Params.custom_js "!=" nil) }}
{{ range .Page.Params.custom_js -}}
  {{ $js := resources.Get . }}
  {{ $pageJSmin := $js | minify }}
  {{ $pageJSminSecure := $pageJSmin | resources.Fingerprint "sha512" }}
  <script src="{{ $pageJSmin.Permalink }}" integrity="{{ $pageJSminSecure.Data.Integrity }}"></script>
{{- end }}
{{ end }}

<script>
$(document).ready(function(e) {
    $('img[usemap]').rwdImageMaps();
});
tocbot.init({
  // Where to render the table of contents.
  tocSelector: '#js-toc',
  // Where to grab the headings to build the table of contents.
  contentSelector: '#main-content',
  // Which headings to grab inside of the contentSelector element.
  headingSelector: '{{if and (isset $.Params "sidenav") ((isset $.Params.sidenav "headingselectors")) }}{{ .Params.sidenav.headingselectors }}{{ else }}h2, h3, h4{{ end }}',
  // For headings inside relative or absolute positioned containers within content.
  hasInnerContainers: true,
  orderedList: false,
  listClass: 'usa-sidenav',
  listItemClass: 'usa-sidenav__item bg-primary-lighter',
  activeLinkClass: 'usa-current'
});
</script>
{{ block "foot" . }}
{{ partial "foot.html" . }}
{{ end }}
</body>
</html>
{{ end }}
